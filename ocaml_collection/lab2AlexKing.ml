(*Alex King (no partner) CSCI 2041 Lab 2*)
let num = fst ;;
let den = snd ;;

let rec gcd i j =
    if i <> 0
    then if j > i
        then gcd i (j - i)
        else gcd (i - j) j
    else j;;

(*rat *)
let rat n d =
    ((n / (gcd n d)), (d / (gcd n d)));;

(*ratAdd *)
let ratAdd a b =
rat ((num a * den b) + (den a * num b)) (den a * den b) ;;

(*ratMul *)
let ratMul a b =
rat ((num a * num b) (den a * den b));;

(*ratDiv *)
let ratDiv a b =
rat (num a * den b) (den a * num b);;

(*ratGt     boolean function*) 
let ratGt a b =
    if (num a * den b) > (den a * num b)
    then true
    else false
    ;;

(*EULER FUNCTION*)
let epsilon = (1,100000);;

let euler =
    let rec eulering c s t =
        if ratGt t epsilon
        then let s' = ratAdd s t
            in let t' = ratDiv t c
                in let c' = ratAdd c (1,1)
                    in eulering c' s' t'
        else s
in eulering (1,1) (0,0) (1,1) ;;



(*Testing functions:*)

let ratPrint (n,d) =
Print.printf "%i / %i\n" n d ;;


let boolPrint b =
Printf.printf "%b\n" b ;;



(* 

TEST RESULTS 

utop # ratPrint (rat 1 2) ;; 
1 / 2
- : unit = ()
─( 14:28:17 )─< command 30 >────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────{ counter: 0 }─
utop # ratPrint (rat 10 20) ;; 
1 / 2
- : unit = ()
─( 14:28:25 )─< command 31 >────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────{ counter: 0 }─
utop # ratPrint (ratAdd (rat 1 2) (rat 1 2)) ;;
1 / 1
- : unit = ()
─( 14:28:32 )─< command 32 >────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────{ counter: 0 }─
utop # ratPrint (ratAdd (rat 1 3) (rat 1 2)) ;; 
5 / 6
- : unit = ()
─( 14:28:39 )─< command 33 >────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────{ counter: 0 }─
utop # ratPrint (ratMul (rat 1 2) (rat 10 1)) ;;
5 / 1
- : unit = ()
─( 14:28:45 )─< command 34 >────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────{ counter: 0 }─
utop # ratPrint (ratMul (rat 2 3) (rat 4 5)) ;;
8 / 15
- : unit = ()
─( 14:28:55 )─< command 35 >────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────{ counter: 0 }─
utop # ratPrint (ratDiv (rat 1 2) (rat 10 2)) ;;
1 / 10
- : unit = ()
─( 14:29:03 )─< command 36 >────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────{ counter: 0 }─
utop # ratPrint (ratDiv (rat 1 2) (rat 1 3)) ;;
3 / 2
- : unit = ()
─( 14:29:11 )─< command 37 >────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────{ counter: 0 }─
utop # boolPrint (ratGt (rat 1 2) (rat 1 3)) ;;
true
- : unit = ()
─( 14:29:21 )─< command 38 >────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────{ counter: 0 }─
utop # boolPrint (ratGt (rat 1 3) (rat 1 2)) ;;
false
- : unit = ()
─( 14:29:30 )─< command 39 >────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────{ counter: 0 }─
utop # ratPrint (euler) ;;
109601 / 40320
- : unit = ()
─( 14:29:39 )─< command 40 >────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────{ counter: 0 }─
utop # 




     *)



















